<!DOCTYPE html>
<html>
<head>
    <title>ðŸ˜ˆ Level Devil ðŸ˜ˆ</title>
    <link rel="icon" type="image/x-icon" href="https://math.hws.edu/favicon.ico">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    </style>
</head>
<body>
    <iframe id="gameFrame" src="https://leveldevil-unblocked.github.io/" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen allow="fullscreen *; autoplay; gamepad"></iframe>

    <script>
        const iframe = document.getElementById('gameFrame');
        const ORIGINAL_SRC = 'https://leveldevil-unblocked.github.io/';
        let isChecking = false;
        let checkTimeout;

        // Main detection: iframe load event fires when redirect destination finishes loading
        iframe.addEventListener('load', () => {
            // Clear any pending checks
            clearTimeout(checkTimeout);
            
            // Small delay to ensure content is fully rendered
            checkTimeout = setTimeout(() => {
                checkIfBlocked();
            }, 100);
        });

        function checkIfBlocked() {
            try {
                // Try to access iframe content
                const currentUrl = iframe.contentWindow.location.href;
                
                // If we can read the URL and it's not our original site, we're redirected
                if (currentUrl && !currentUrl.includes('leveldevil-unblocked.github.io')) {
                    // Check if it's a blocked page
                    if (currentUrl.includes('securly.com') || 
                        currentUrl.includes('blocked')) {
                        location.reload();
                    } else {
                        // Redirected somewhere else, still reload to get back to game
                        location.reload();
                    }
                }
            } catch (e) {
                // Cross-origin error means we're on a different domain
                // This confirms redirect happened - now reload
                location.reload();
            }
        }

        // Backup: Monitor title changes (some blockers change title after load)
        const titleObserver = new MutationObserver(() => {
            const title = document.title.toLowerCase();
            if (title.includes('securly') || 
                title.includes('blocked') || 
                title.includes('access denied')) {
                location.reload();
            }
        });
        
        titleObserver.observe(document.querySelector('title'), {
            childList: true,
            subtree: true,
            characterData: true
        });

        // Backup: Periodic check for cross-origin state (indicates redirect)
        setInterval(() => {
            try {
                const currentUrl = iframe.contentWindow.location.href;
                // If we can read URL but it's not our site, we were redirected
                if (currentUrl && !currentUrl.includes('leveldevil-unblocked.github.io')) {
                    // Wait a bit for page to finish loading, then reload
                    setTimeout(() => location.reload(), 200);
                }
            } catch (e) {
                // Cross-origin error = redirected to different domain
                // Wait for load to complete, then refresh
                setTimeout(() => location.reload(), 500);
            }
        }, 1000);
    </script>
</body>
</html>
