<!DOCTYPE html>
<html>
<head>
    <title>ðŸ˜ˆ Level Devil ðŸ˜ˆ</title>
    <link rel="icon" type="image/x-icon" href="https://math.hws.edu/favicon.ico">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    </style>
</head>
<body>
    <iframe id="gameFrame" src="https://leveldevil-unblocked.github.io/" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen allow="fullscreen *; autoplay; gamepad"></iframe>

    <script>
        const iframe = document.getElementById('gameFrame');
        const ORIGINAL_SRC = 'https://leveldevil-unblocked.github.io/';
        let reloadTimeout;
        let isReloading = false;

        // Main detection: iframe load event fires when redirect destination finishes loading
        iframe.addEventListener('load', () => {
            // Clear any pending reload
            clearTimeout(reloadTimeout);
            
            if (isReloading) return;
            
            // Give it plenty of time to fully load (3 seconds)
            reloadTimeout = setTimeout(() => {
                checkIfBlocked();
            }, 3000);
        });

        function checkIfBlocked() {
            if (isReloading) return;
            
            try {
                // Try to access iframe content
                const currentUrl = iframe.contentWindow.location.href;
                
                // If we can read the URL and it's not our original site, we're redirected
                if (currentUrl && !currentUrl.includes('leveldevil-unblocked.github.io')) {
                    isReloading = true;
                    // Extra delay before reload to ensure everything settled (2 seconds)
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                }
            } catch (e) {
                // Cross-origin error means we're on a different domain
                // This confirms redirect happened - wait extra time then reload
                isReloading = true;
                setTimeout(() => {
                    location.reload();
                }, 4000);
            }
        }

        // Backup: Monitor title changes with delay
        const titleObserver = new MutationObserver(() => {
            if (isReloading) return;
            
            const title = document.title.toLowerCase();
            if (title.includes('securly') || 
                title.includes('blocked') || 
                title.includes('access denied')) {
                
                isReloading = true;
                // Wait 5 seconds after title change to ensure page fully loaded
                setTimeout(() => {
                    location.reload();
                }, 5000);
            }
        });
        
        titleObserver.observe(document.querySelector('title'), {
            childList: true,
            subtree: true,
            characterData: true
        });

        // Backup: Periodic check for cross-origin state
        setInterval(() => {
            if (isReloading) return;
            
            try {
                const currentUrl = iframe.contentWindow.location.href;
                if (currentUrl && !currentUrl.includes('leveldevil-unblocked.github.io')) {
                    isReloading = true;
                    // Wait 4 seconds for page to fully settle
                    setTimeout(() => location.reload(), 4000);
                }
            } catch (e) {
                // Cross-origin error = redirected
                isReloading = true;
                // Wait 6 seconds for blocked page to completely render
                setTimeout(() => location.reload(), 6000);
            }
        }, 2000);
    </script>
</body>
</html>
